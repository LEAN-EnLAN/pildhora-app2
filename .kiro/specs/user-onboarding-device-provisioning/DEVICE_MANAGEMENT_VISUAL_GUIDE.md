# Patient Device Management Screen - Visual Guide

## Screen Overview

The patient device management screen provides a comprehensive interface for patients to manage their device connections, view connected caregivers, and control access through connection codes.

## Screen Sections

### 1. Header
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† GestiÃ³n de Dispositivo                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Back button (arrow-back icon)
- Screen title "GestiÃ³n de Dispositivo"
- Clean, minimal design

### 2. Device Information Card
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”² ID del Dispositivo                   â”‚
â”‚    DEVICE-ABC123XYZ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Hardware chip icon (blue)
- Device ID label
- Monospace device ID display
- Elevated card style

### 3. Connected Caregivers Section
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cuidadores Conectados                   â”‚
â”‚ Personas que tienen acceso a tu         â”‚
â”‚ informaciÃ³n de medicamentos             â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ‘¤ Dr. MarÃ­a GarcÃ­a                 â”‚ â”‚
â”‚ â”‚    maria@example.com                â”‚ â”‚
â”‚ â”‚    Conectado: 15 de enero de 2024   â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚    [Revocar Acceso]                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ‘¤ Enfermera Ana LÃ³pez              â”‚ â”‚
â”‚ â”‚    ana@example.com                  â”‚ â”‚
â”‚ â”‚    Conectado: 10 de enero de 2024   â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚    [Revocar Acceso]                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Empty State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cuidadores Conectados                   â”‚
â”‚ Personas que tienen acceso a tu         â”‚
â”‚ informaciÃ³n de medicamentos             â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚         ğŸ‘¥                          â”‚ â”‚
â”‚ â”‚   No hay cuidadores conectados      â”‚ â”‚
â”‚ â”‚   Genera un cÃ³digo de conexiÃ³n      â”‚ â”‚
â”‚ â”‚   para compartir con un cuidador    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Connection Codes Section
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CÃ³digos de ConexiÃ³n    [Generar CÃ³digo] â”‚
â”‚ CÃ³digos activos para conectar nuevos    â”‚
â”‚ cuidadores                              â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ”‘ A B C 1 2 3                      â”‚ â”‚
â”‚ â”‚    Expira en 5h 30m                 â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚    [ğŸ“¤ Compartir]  [ğŸ—‘ï¸ Revocar]     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ”‘ X Y Z 7 8 9                      â”‚ â”‚
â”‚ â”‚    Expira en 23h 15m                â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚    [ğŸ“¤ Compartir]  [ğŸ—‘ï¸ Revocar]     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Empty State:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CÃ³digos de ConexiÃ³n    [Generar CÃ³digo] â”‚
â”‚ CÃ³digos activos para conectar nuevos    â”‚
â”‚ cuidadores                              â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚         ğŸ”‘                          â”‚ â”‚
â”‚ â”‚   No hay cÃ³digos activos            â”‚ â”‚
â”‚ â”‚   Genera un cÃ³digo para compartir   â”‚ â”‚
â”‚ â”‚   con un cuidador                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. Help Section
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â„¹ï¸ Â¿CÃ³mo funciona?                      â”‚
â”‚                                         â”‚
â”‚ 1. Genera un cÃ³digo de conexiÃ³n        â”‚
â”‚ 2. Comparte el cÃ³digo con tu cuidador  â”‚
â”‚ 3. El cuidador ingresa el cÃ³digo en    â”‚
â”‚    su app                               â”‚
â”‚ 4. Una vez conectado, podrÃ¡ ver y      â”‚
â”‚    gestionar tus medicamentos          â”‚
â”‚                                         â”‚
â”‚ Los cÃ³digos expiran en 24 horas y      â”‚
â”‚ solo pueden usarse una vez.            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## User Flows

### Flow 1: Generate and Share Connection Code
```
1. User taps "Generar CÃ³digo"
   â†“
2. Loading indicator shows
   â†“
3. Code is generated (e.g., "ABC123")
   â†“
4. Success message displays with code
   â†“
5. Alert dialog offers to share
   â†“
6. User taps "Compartir"
   â†“
7. Native share dialog opens
   â†“
8. User shares via SMS, email, etc.
   â†“
9. Code appears in active codes list
```

### Flow 2: Revoke Caregiver Access
```
1. User taps "Revocar Acceso" on caregiver card
   â†“
2. Confirmation dialog appears:
   "Â¿EstÃ¡s seguro de que deseas revocar
    el acceso de Dr. MarÃ­a GarcÃ­a?"
   â†“
3. User taps "Revocar"
   â†“
4. Loading indicator shows
   â†“
5. Device link is removed
   â†“
6. Success message displays
   â†“
7. Caregiver card is removed from list
   â†“
8. Caregiver loses access immediately
```

### Flow 3: Revoke Connection Code
```
1. User taps "Revocar" on code card
   â†“
2. Confirmation dialog appears:
   "Â¿EstÃ¡s seguro de que deseas revocar
    este cÃ³digo?"
   â†“
3. User taps "Revocar"
   â†“
4. Loading indicator shows
   â†“
5. Code is deleted from Firestore
   â†“
6. Success message displays
   â†“
7. Code card is removed from list
   â†“
8. Code can no longer be used
```

### Flow 4: Pull to Refresh
```
1. User pulls down on screen
   â†“
2. Refresh indicator shows
   â†“
3. Data is reloaded from Firestore
   â†“
4. Caregivers list updates
   â†“
5. Connection codes list updates
   â†“
6. Refresh indicator disappears
```

## Color Scheme

### Icons
- **Device Info**: Blue (`colors.primary[600]`)
- **Caregivers**: Blue (`colors.primary[600]`)
- **Connection Codes**: Green (`colors.success[600]`)
- **Help**: Blue (`colors.primary[600]`)

### Buttons
- **Primary** (Generate Code): Blue background
- **Secondary** (Share): Gray background
- **Danger** (Revoke): Red background

### Cards
- **Elevated**: White with shadow
- **Outlined** (Help): White with border

## Responsive Behavior

### Small Screens (< 375px)
- Single column layout
- Full-width cards
- Stacked buttons in code cards

### Medium Screens (375px - 768px)
- Single column layout
- Full-width cards
- Side-by-side buttons in code cards

### Large Screens (> 768px)
- Single column layout (centered)
- Max width constraint
- Side-by-side buttons in code cards

## Accessibility Features

### Screen Reader Support
- All buttons have descriptive labels
- Card content is properly structured
- Status messages are announced

### Touch Targets
- All buttons meet 44x44 minimum size
- Adequate spacing between interactive elements
- Large tap areas for cards

### Visual Indicators
- High contrast text
- Clear focus states
- Color + icon + text for status

## Error States

### Network Error
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ Error al cargar datos               â”‚
â”‚ Por favor, verifica tu conexiÃ³n a      â”‚
â”‚ internet e intenta nuevamente.         â”‚
â”‚                                         â”‚
â”‚ [Reintentar]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### No Device Linked
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         âš ï¸                              â”‚
â”‚   No hay dispositivo vinculado         â”‚
â”‚                                         â”‚
â”‚   Primero debes vincular un            â”‚
â”‚   dispositivo para gestionar           â”‚
â”‚   cuidadores y cÃ³digos de conexiÃ³n.    â”‚
â”‚                                         â”‚
â”‚   [Vincular Dispositivo]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Code Generation Error
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ Error al generar cÃ³digo             â”‚
â”‚ No se pudo generar un cÃ³digo Ãºnico.    â”‚
â”‚ Por favor, intenta nuevamente.         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Success States

### Code Generated
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… CÃ³digo generado: ABC123             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Caregiver Revoked
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Acceso de Dr. MarÃ­a GarcÃ­a          â”‚
â”‚    revocado exitosamente               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Code Revoked
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… CÃ³digo revocado exitosamente        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Animation & Transitions

### Card Entrance
- Fade in with slight scale up
- Staggered animation for multiple cards
- Duration: 300ms

### Button Press
- Scale down to 0.95
- Haptic feedback (if available)
- Duration: 100ms

### List Updates
- Smooth removal animation
- Fade out + slide up
- Duration: 200ms

### Pull to Refresh
- Native refresh control
- Smooth spring animation
- Automatic dismiss on complete

## Best Practices

### Data Loading
- Show loading state immediately
- Use skeleton loaders for cards
- Provide pull-to-refresh option

### User Feedback
- Always show success/error messages
- Use confirmation dialogs for destructive actions
- Provide clear action outcomes

### Error Handling
- User-friendly error messages in Spanish
- Retry options for network errors
- Graceful degradation for missing data

### Performance
- Efficient Firestore queries
- Minimal re-renders
- Optimistic UI updates where possible

## Integration Points

### Services Used
- `connectionCode.ts` - Code generation and management
- `deviceLinking.ts` - Caregiver link management
- `firebase.ts` - Firestore and RTDB access

### Collections Accessed
- `deviceLinks` - Caregiver connections
- `connectionCodes` - Active codes
- `users` - User profile data

### State Management
- Local component state
- Redux for user authentication
- No global state for this screen

## Testing Checklist

- [ ] Screen loads with device ID
- [ ] Screen shows empty state without device
- [ ] Caregivers list displays correctly
- [ ] Connection codes list displays correctly
- [ ] Generate code button works
- [ ] Share code functionality works
- [ ] Revoke caregiver confirmation works
- [ ] Revoke code confirmation works
- [ ] Pull to refresh works
- [ ] Error messages display correctly
- [ ] Success messages display correctly
- [ ] Back button navigates correctly
- [ ] All accessibility labels present
- [ ] Screen reader navigation works
- [ ] Touch targets are adequate size
